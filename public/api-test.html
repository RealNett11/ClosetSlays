<!DOCTYPE html>
<html>
<head>
    <title>API Test</title>
</head>
<body>
    <h1>ClosetSlays API Test</h1>
    <div id="results"></div>
    
    <script>
        const API_BASE = 'https://webhook.closetslays.com';
        const results = document.getElementById('results');
        
        async function testEndpoint(method, endpoint, body = null) {
            try {
                const options = {
                    method,
                    headers: {
                        'Content-Type': 'application/json',
                    }
                };
                
                if (body) {
                    options.body = JSON.stringify(body);
                }
                
                const response = await fetch(`${API_BASE}${endpoint}`, options);
                const contentType = response.headers.get('content-type');
                
                let responseText;
                if (contentType && contentType.includes('application/json')) {
                    responseText = JSON.stringify(await response.json(), null, 2);
                } else {
                    responseText = await response.text();
                }
                
                results.innerHTML += `
                    <div style="margin: 10px 0; padding: 10px; border: 1px solid #ccc;">
                        <h3>${method} ${endpoint}</h3>
                        <p><strong>Status:</strong> ${response.status} ${response.statusText}</p>
                        <p><strong>Content-Type:</strong> ${contentType}</p>
                        <pre style="background: #f5f5f5; padding: 10px; overflow-x: auto;">${responseText}</pre>
                    </div>
                `;
            } catch (error) {
                results.innerHTML += `
                    <div style="margin: 10px 0; padding: 10px; border: 1px solid red;">
                        <h3>${method} ${endpoint}</h3>
                        <p><strong>Error:</strong> ${error.message}</p>
                    </div>
                `;
            }
        }
        
        // Test endpoints
        (async () => {
            await testEndpoint('GET', '/api/health');
            await testEndpoint('GET', '/api');
            await testEndpoint('POST', '/api/create-payment-intent', { items: [{ id: 1, name: 'Test', price: 20, quantity: 1 }] });
            await testEndpoint('POST', '/api/shipping-options', { address: { country: 'US' }, items: [] });
        })();
    </script>
</body>
</html>
